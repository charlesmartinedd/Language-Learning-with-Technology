---
import BaseLayout from '../../../layouts/BaseLayout.astro';
---

<BaseLayout title="Course Certificate">
  <div class="certificate-page">
    <h1>Generate Your Certificate</h1>
    <p class="subtitle">Congratulations! You've passed the quiz. Generate your certificate below.</p>

    <div class="form-container">
      <form id="certificateForm">
        <div class="form-group">
          <label for="studentName">Name:</label>
          <input type="text" id="studentName" name="studentName" required class="form-input" />
        </div>
        <button type="submit" class="btn-primary">Generate Certificate</button>
      </form>
    </div>

    <div id="certificatePreview" class="certificate-preview" style="display: none;">
      <div class="certificate" id="certificate">
        <div class="certificate-border">
          <div class="certificate-content">
            <div class="logo-circle">üåê</div>
            <h1 class="course-title">Language Learning with Technology</h1>
            <h2 class="certificate-type">Certificate of Completion</h2>
            <p class="presented-to">This certifies that</p>
            <h3 class="recipient-name" id="certName">Student Name</h3>
            <p class="completion-text">has successfully completed</p>
            <h4 class="lesson-title">Lesson 1: Getting Started with Digital Language Learning</h4>
            <div class="score-badge">
              <span class="score-label">Quiz Score</span>
              <span class="score-value" id="certScore">100%</span>
            </div>
            <div class="signature-section">
              <p class="date-value" id="certDate">January 1, 2025</p>
              <p class="signature-label">Date of Completion</p>
            </div>
          </div>
        </div>
      </div>
      <div class="certificate-actions">
        <button id="printCert" class="btn-primary">Print Certificate</button>
      </div>
    </div>
  </div>
</BaseLayout>

<style>
  .certificate-page {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  h1 {
    text-align: center;
    color: #1e40af;
  }

  .subtitle {
    text-align: center;
    color: #6b7280;
    margin-bottom: 2rem;
  }

  .form-container {
    max-width: 500px;
    margin: 0 auto 3rem;
    background: white;
    border: 2px solid #3b82f6;
    border-radius: 12px;
    padding: 2rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  label {
    display: block;
    font-weight: 600;
    color: #1e40af;
    margin-bottom: 0.5rem;
  }

  .form-input {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #e5e7eb;
    border-radius: 6px;
    font-size: 1rem;
  }

  .certificate {
    background: white;
    padding: 2rem;
    margin: 0 auto 2rem;
    max-width: 800px;
  }

  .certificate-border {
    border: 8px double #1e40af;
    padding: 3rem 2rem;
    background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%);
  }

  .certificate-content {
    text-align: center;
  }

  .logo-circle {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #1e40af, #3b82f6);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    margin: 0 auto 1rem;
  }

  .course-title {
    font-size: 1.5rem;
    color: #1e40af;
    margin-bottom: 2rem;
  }

  .certificate-type {
    font-size: 2rem;
    color: #1e3a8a;
    margin-bottom: 2rem;
  }

  .recipient-name {
    font-size: 2.5rem;
    color: #1e40af;
    margin: 1rem 0;
    font-family: 'Georgia', serif;
    border-bottom: 3px solid #3b82f6;
    display: inline-block;
    padding-bottom: 0.5rem;
  }

  .score-badge {
    display: inline-block;
    background: linear-gradient(135deg, #1e40af, #3b82f6);
    color: white;
    padding: 1rem 2rem;
    border-radius: 50px;
    margin: 2rem 0;
  }

  .score-value {
    font-size: 1.5rem;
    font-weight: 700;
  }

  .certificate-actions {
    text-align: center;
  }

  .btn-primary {
    padding: 0.875rem 2rem;
    border-radius: 6px;
    font-weight: 600;
    background: #1e40af;
    color: white;
    border: none;
    cursor: pointer;
  }

  .btn-primary:hover {
    background: #1e3a8a;
  }

  @media print {
    .form-container, .certificate-actions, .subtitle {
      display: none !important;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('certificateForm');
    const preview = document.getElementById('certificatePreview');

    const urlParams = new URLSearchParams(window.location.search);
    const score = urlParams.get('score') || '100';

    form?.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = (document.getElementById('studentName') as HTMLInputElement).value;
      const date = new Date().toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });

      (document.getElementById('certName') as HTMLElement).textContent = name;
      (document.getElementById('certScore') as HTMLElement).textContent = `${score}%`;
      (document.getElementById('certDate') as HTMLElement).textContent = date;

      if (preview) preview.style.display = 'block';
      preview?.scrollIntoView({ behavior: 'smooth' });
    });

    document.getElementById('printCert')?.addEventListener('click', () => {
      window.print();
    });
  });
</script>
</BaseLayout>
